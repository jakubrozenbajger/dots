#!/bin/sh

cmd="$(echo "
 lock
 dim
 exit
 suspend
 reboot
 shutdown
" | xargs -n2 \
  | rofi -dmenu -width 15 -hide-scrollbar -lines 6 -i -no-custom -p "?" \
  | awk '{print $2}')";

case $DESKTOP_SESSION in
  i3)     _exit_cmd="i3-msg exit" ;;
  xmonad) _exit_cmd="$XMONAD_CONFIG_DIR/xmonadctl quit-wm" ;;
  bspwm)  _exit_cmd="bspc quit" ;;
  dwm)    _exit_cmd="pkill dwm" ;;
  *)      _exit_cmd="notify-send 'Exiting for session $DESKTOP_SESSION not supporrted'";;
esac

case "$cmd" in
  lock)
    loginctl lock-session
    ;;
  dim)
    xset dpms force off
    ;;
  exit)
    eval "$_exit_cmd"
    ;;
  suspend)
    systemctl suspend
    ;;
  reboot)
    systemctl reboot
    ;;
  shutdown)
    systemctl poweroff
    ;;
  *)
    echo "missing or invalid argument"
    exit 2
esac
