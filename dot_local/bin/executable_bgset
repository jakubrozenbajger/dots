#!/usr/bin/env sh

WALLPAPERS_DIR="${WALLPAPERS_DIR:-"$HOME/Pictures/Wallpapers"}"

[ -d "$WALLPAPERS_DIR" ] || mkdir -p "$WALLPAPERS_DIR"

BG_SETTER="betterlockscreen -u"
BG_CURRENT="$WALLPAPERS_DIR/current"

bg="${1:-$BG_CURRENT}"
[ -z "$bg" ] && echo "Usage $0 <path to image> or <image name in WALLPAPERS_DIR=$WALLPAPERS_DIR>" && exit 1

[ ! -f "$bg" ] && bg="$WALLPAPERS_DIR/$bg"
[ ! -f "$bg" ] && echo "No such file!" && exit 1

echo "Setting $bg as background"

[ "$bg" = "$BG_CURRENT" ] || ln -fs "$bg" "$BG_CURRENT"

$BG_SETTER "$BG_CURRENT"

